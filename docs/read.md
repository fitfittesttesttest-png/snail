-----

# ECサイトの商品購入（決済画面）

## 概要

  - ユーザーがカートに入れた商品を購入するための決済機能。

-----

## 画面イメージ

-----

## 項目設計

| 項目名 | I/O | データ型 | 制約 |
|---|---|---|---|
| 配送先住所 | I | String | **必須**、最大100文字、住所形式 |
| 郵便番号 | I | String | **必須**、ハイフンなし7桁の半角数字 |
| 決済方法 | I | String | **必須**、選択形式（クレジットカード/銀行振込/代金引換） |
| カード番号 | I | String | 決済方法が「クレジットカード」の場合**必須**、14桁〜16桁の半角数字、ハイフン不可 |
| 有効期限（月/年） | I | String | 決済方法が「クレジットカード」の場合**必須**、MM/YY形式、過去の日付不可 |
| セキュリティコード | I | String | 決済方法が「クレジットカード」の場合**必須**、3桁または4桁の半角数字 |

-----

## 動作一覧

| 動作名 | 説明 | トリガー | 処理内容 | 成功時の挙動 | 失敗時の挙動 |
|---|---|---|---|---|---|
| 入力内容のリアルタイム検証 | ユーザーが決済に必要な情報を入力した際にリアルタイムで検証を実施する。 | ・入力欄への文字入力<br>・フォーカス移動 | 住所/郵便番号: 必須チェック、形式チェック<br>カード情報: 必須チェック、桁数チェック、有効期限チェック | 入力欄の下にエラー表示なし。 | エラーメッセージを入力欄下に表示し、該当入力欄を**赤枠で強調**。 |
| 支払い方法による項目切り替え | ユーザーが支払い方法を選択した際に、関連する入力項目を表示/非表示にする。 | 決済方法のドロップダウン選択 | 選択値が「クレジットカード」の場合: カード情報欄を**表示**<br>それ以外: カード情報欄を**非表示** | 適切な入力項目が表示または非表示となる。 | N/A |
| 注文確定ボタンの状態切り替え | すべての必須項目（選択された決済方法に応じたカード情報も含む）に有効な値が入力された場合に「注文確定ボタン」を有効化する。 | 入力欄の値が変更されたとき | すべての必須項目が**有効**な場合: ボタン有効化<br>一つでも**無効**な場合: ボタン無効化 | ボタンがクリック可能となる。 | ボタンが**非活性状態**となる。 |
| 注文確定処理 | ユーザーが「注文確定ボタン」をクリックした際に、注文および決済処理を実施する。 | 注文確定ボタンクリック | 注文内容、配送先、および決済情報をサーバーに送信し、在庫確保と決済手続きを行う。 | 注文完了: **注文完了画面**へ遷移（注文番号を表示） | 決済エラーまたは在庫不足: **エラーメッセージ**（例: 「クレジットカードの認証に失敗しました」「在庫が不足しています」）を表示 |

-----

この「ECサイトの商品購入」仕様について、さらに**エラーメッセージの具体例**を追記するなど、特定の動作を詳細化しますか？
